<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Data Peserta Kegiatan SDM Pariwisata</title>
  <!-- TailwindCSS -->
  <link href="https://cdn.tailwindcss.com" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- SheetJS -->
  <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>

  <style>
    /* CSS yang diperbaiki */
    #login-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      z-index: 9999;
      justify-content: center;
      align-items: center;
    }

    .login-box {
      background: white;
      padding: 2rem;
      border-radius: 0.5rem;
      width: 100%;
      max-width: 400px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    }

    /* ... (CSS lainnya tetap sama) ... */
  </style>
</head>
<body class="text-gray-800">
  <!-- Admin Panel -->
  <div id="admin-panel" class="fixed top-4 right-4 z-50">
    <button id="admin-toggle" class="bg-blue-600 text-white px-4 py-2 rounded-lg shadow-md hover:bg-blue-700 transition">
      <i class="fas fa-lock mr-2"></i>Login
    </button>
  </div>

  <!-- Konten utama -->
  <div class="container mx-auto px-4 py-8 max-w-7xl">
    <!-- ... (Konten utama tetap sama) ... -->
  </div>

  <!-- Login Modal -->
  <div id="login-modal">
    <div class="login-box">
      <h2 class="text-2xl font-bold text-center mb-6">Login Admin</h2>
      <input type="password" id="admin-password" class="login-input" placeholder="Password">
      <button id="login-btn" class="login-btn">Masuk</button>
      <p id="login-error" class="text-red-500 text-sm mt-2 text-center"></p>
    </div>
  </div>

  <!-- Edit Modal -->
  <!-- ... (Modal edit tetap sama) ... -->

  <script>
    // Inisialisasi data dan fungsi utama
    let originalData = [];
    let currentEditIndex = -1;
    const ADMIN_PASSWORD = "admin123"; // Ganti password ini
    let isAdmin = localStorage.getItem('adminLoggedIn') === 'true';

    // Fungsi toggle admin controls
    function toggleAdminControls() {
      const adminElements = document.querySelectorAll('[data-admin]');
      adminElements.forEach(el => {
        el.style.display = isAdmin ? 'block' : 'none';
      });
      
      document.getElementById('admin-toggle').innerHTML = isAdmin ?
        '<i class="fas fa-unlock mr-2"></i>Logout' :
        '<i class="fas fa-lock mr-2"></i>Login';
    }

    // Fungsi login/logout
    function handleAuth() {
      if (isAdmin) {
        isAdmin = false;
        localStorage.removeItem('adminLoggedIn');
      } else {
        const password = prompt('Masukkan password admin:');
        if (password === ADMIN_PASSWORD) {
          isAdmin = true;
          localStorage.setItem('adminLoggedIn', 'true');
        } else {
          alert('Password salah!');
        }
      }
      toggleAdminControls();
    }

    // Event listeners untuk admin
    document.getElementById('admin-toggle').addEventListener('click', handleAuth);

    // Inisialisasi tahun dropdown
    function initTahunDropdowns() {
      const currentYear = new Date().getFullYear();
      const startYear = 2019;
      const endYear = currentYear + 5;

      document.querySelectorAll('.tahun-dropdown').forEach(dropdown => {
        dropdown.innerHTML = '<option value="">Pilih Tahun</option>';
        for (let year = startYear; year <= endYear; year++) {
          dropdown.innerHTML += `<option value="${year}">${year}</option>`;
        }
      });
    }

    // ... (Fungsi lainnya tetap sama) ...

    // Inisialisasi awal
    document.addEventListener('DOMContentLoaded', function() {
      initTahunDropdowns();
      loadData();
      toggleAdminControls();
    });
  </script>
</body>
</html>
